diff -Naur -X /usr/local/bin/exclude.txt shorewall-perl-4.0.12/install.sh shorewall-perl-4.0.12.1/install.sh
--- shorewall-perl-4.0.12/install.sh	2008-06-24 06:40:32.000000000 -0700
+++ shorewall-perl-4.0.12.1/install.sh	2008-06-29 16:16:25.000000000 -0700
@@ -22,7 +22,7 @@
 #       Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 #
 
-VERSION=4.0.12
+VERSION=4.0.12.1
 
 usage() # $1 = exit status
 {
diff -Naur -X /usr/local/bin/exclude.txt shorewall-perl-4.0.12/patch-perl-4.0.12.1 shorewall-perl-4.0.12.1/patch-perl-4.0.12.1
--- shorewall-perl-4.0.12/patch-perl-4.0.12.1	1969-12-31 16:00:00.000000000 -0800
+++ shorewall-perl-4.0.12.1/patch-perl-4.0.12.1	2008-06-29 16:14:07.000000000 -0700
@@ -0,0 +1,16 @@
+Index: Shorewall/Compiler.pm
+===================================================================
+--- Shorewall/Compiler.pm	(revision 8500)
++++ Shorewall/Compiler.pm	(working copy)
+@@ -657,6 +657,11 @@
+     else
+         fatal_error "$iptables_save_file does not exist"
+     fi
++EOF
++    pop_indent;
++    setup_forwarding;
++    push_indent;
++    emit<<'EOF';
+     set_state "Started"
+ else
+     if [ $COMMAND = refresh ]; then
diff -Naur -X /usr/local/bin/exclude.txt shorewall-perl-4.0.12/Shorewall/Compiler.pm shorewall-perl-4.0.12.1/Shorewall/Compiler.pm
--- shorewall-perl-4.0.12/Shorewall/Compiler.pm	2008-04-06 06:57:42.000000000 -0700
+++ shorewall-perl-4.0.12.1/Shorewall/Compiler.pm	2008-06-29 16:09:35.000000000 -0700
@@ -657,6 +657,11 @@
     else
         fatal_error "$iptables_save_file does not exist"
     fi
+EOF
+    pop_indent;
+    setup_forwarding;
+    push_indent;
+    emit<<'EOF';
     set_state "Started"
 else
     if [ $COMMAND = refresh ]; then
diff -Naur -X /usr/local/bin/exclude.txt shorewall-perl-4.0.12/Shorewall/Config.pm shorewall-perl-4.0.12.1/Shorewall/Config.pm
--- shorewall-perl-4.0.12/Shorewall/Config.pm	2008-06-24 06:40:32.000000000 -0700
+++ shorewall-perl-4.0.12.1/Shorewall/Config.pm	2008-06-29 16:16:25.000000000 -0700
@@ -244,7 +244,7 @@
 		    ORIGINAL_POLICY_MATCH => '',
 		    LOGPARMS => '',
 		    TC_SCRIPT => '',
-		    VERSION => "4.0.12",
+		    VERSION => "4.0.12.1",
 		    CAPVERSION => 40006 ,
 		  );
     #
diff -Naur -X /usr/local/bin/exclude.txt shorewall-perl-4.0.12/Shorewall/Rules.pm shorewall-perl-4.0.12.1/Shorewall/Rules.pm
--- shorewall-perl-4.0.12/Shorewall/Rules.pm	2008-06-16 14:39:28.000000000 -0700
+++ shorewall-perl-4.0.12.1/Shorewall/Rules.pm	2008-04-19 10:31:03.000000000 -0700
@@ -1570,7 +1570,7 @@
 
 	if ( $config{DYNAMIC_ZONES} ) {
 	    push @rule_chains , [ firewall_zone , $zone , $chain1 ] if $chain1;
-	    push @rule_chains , [ $zone , firewall_zone , $chain2 ] if $chain2;
+	    push @rule_chains , [ $zone , firewall_zone , $chain2 ];
 	}
 
 	#
diff -Naur -X /usr/local/bin/exclude.txt shorewall-perl-4.0.12/shorewall-perl.spec shorewall-perl-4.0.12.1/shorewall-perl.spec
--- shorewall-perl-4.0.12/shorewall-perl.spec	2008-06-24 06:40:32.000000000 -0700
+++ shorewall-perl-4.0.12.1/shorewall-perl.spec	2008-06-29 16:16:25.000000000 -0700
@@ -1,6 +1,6 @@
 %define name shorewall-perl
 %define version 4.0.12
-%define release 0base
+%define release 1
 
 Summary: Shoreline Firewall Perl-based compiler.
 Name: %{name}
@@ -64,6 +64,8 @@
 %doc COPYING releasenotes.txt
 
 %changelog
+* Sun Jun 29 2008 Tom Eastep tom@shorewall.net
+- Updated to 4.0.12-1
 * Tue Jun 24 2008 Tom Eastep tom@shorewall.net
 - Updated to 4.0.12-0base
 * Mon May 19 2008 Tom Eastep tom@shorewall.net
